<span>
  <h4 id='project_heading'><%= @project.title %>&nbsp;
  <%= link_to project_change_name_path(@project) do %>
     <i class="icon-edit" style='margin-top:5px'></i>
  <% end %></h4><br>
</span>
<div class='row'>
  <div class='span2'>
    <ul class="nav nav-list">
      <li class='active'>
        <a href='#dashboard_tab', data-toggle="tab">Dashboard</a>
      </li>
      <li>
        <a href='#overview_tab', data-toggle='tab', remote: true>Overview</a>
      </li>
    </ul>
  </div>
  <div class='span6'>
    <%= simple_form_for(@project, html: { class: 'form-vertical active-table-form' }) do |f| %>
    <div class='tab-content' id='content_spread'>
      <div id='dashboard_tab', class='tab-pane active' style='padding:20px'>
        <%= render partial: 'dashboards/show', locals: { project: @project } %>
      </div>
        <div id='overview_tab', class='tab-pane' style='padding:20px'>
          <%= f.simple_fields_for :overview do |nf| %>
            <%= render partial: 'overview/form', locals: { f: nf } %>
          <% end %>
      </div>
      <div class="form-actions">
        <%= f.submit 'Save', class: 'btn btn-primary' %>
      </div>
    <% end %>
    </div>
  </div>
  <div class='span2' id='invite_column'>
    <%= link_to new_project_collaboration_path(@project), :id => 'invite_colab_button', :class => 'btn btn-success' do %>
      <i class='icon-plus icon-white'></i> Invite Collaborator
    <% end %>
    <br>
    <% @project.collaborations.each do |collaboration| %>
      <br>
      <p>
        <%= filepicker_image_tag collaboration.user.filepicker_url, w: 50, h: 50, fit: 'clip' %>
        <%= link_to collaboration.user.name, url_for({ :controller => 'users', :action => 'show', :id => collaboration.user.id }) %>
      </p>
    <% end %>
    <br />
    <%= link_to 'Manage Collaborators', project_collaborations_path(@project) %>
  </div>
</div>

<%= content_for :js do %>
  <script type='text/javascript'>
   $('.default_fields').find('.controls').each(function() {
    $(this).append('<a herf="#" class="btn btn-link removeDefaultRow"><span class="icon-remove"></span></a>');
   })

   $('.attributeContainer').delegate('.dynamicAttributeName', 'keyup', function(event){
     nameElem  = $(this);
     valueElem = nameElem.closest('.row').children('p').children('.text_field')
     value     = nameElem.val().toLowerCase();
     valueElem.attr('id',          'project' + value       );
     valueElem.attr('name',        'project[' + model + '_attributes][data][' + value + ']');
   })

   $('.attributeContainer').delegate('.removeRow', 'click', function(){
     $(this).closest('.row').html('');
   })

   $('.default_fields').delegate('.removeDefaultRow', 'click', function(){
     var $input = $(this).siblings('input, :first');
     $input.clone().attr('type', 'text').insertAfter($input).val('#removed').prev().remove();
     $(this).closest('div.control-group').hide();
   })

   $('.addAttribute').on('click', function(){
     contents = "<div class='row'>" + $('.attributeTemplate').html() + '</div>';
     $(this).before(contents);
   })
  </script>
<% end %>
